<%= javascript_include_tag "autocompleta_assistido", "datepicker" %>

<h1>Relatório de Acompanhamento de Notificações</h1>

<%= form_tag("/pesquisar", method: "get", remote: true) do %>
    <%= label_tag "Data do alerta: de" %>
    <%= text_field_tag :data_ini, "", class: "campo_data", size: 10 %> 
    até <%= text_field_tag :data_fim, "", class: "campo_data", size: 10 %><br>
    <%= label_tag "Assistido Vinculado:" %><%= text_field_tag :assistido, "", size: 40 %><br>
    <%= label_tag "Descrição" %><%= text_field_tag :descricao, "", size: 50 %><br>
    <%= label_tag "Tipo" %> <%= select_tag :tipo, options_for_select(@tipos) %> 
    <%= label_tag "Status" %> <%= select_tag :status, options_for_select(@status) %>

  <br>
  <br>
  <%= submit_tag "Buscar", class: "btn btn-success" %>
<% end %>
  
<div id="notificacoes_grid">
  <fieldset>
    <legend>Notificações</legend>
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Data do Alerta</th>
          <th>Assistido</th>
          <th>Descrição</th>
          <th>Tipo</th>
          <th>Status</th>
          <th>Data Criação</th>
        </tr>
      </thead>

      <tbody>
        <% @notificacoes.each do |notificacao| %>
          <tr>
            <td><%= (l notificacao.data) %></td>        
            <td>
              <% if notificacao.assistido != nil %>
                <%= notificacao.assistido.nome %>
              <% else %>
                Usuário
              <% end %>              
            </td>
            <td><%= notificacao.descricao %></td>
            <td><%= notificacao.tipo %></td>
            <td>
              <% if notificacao.visto %>
                Já Alertado
              <% else %>
                Não Alertado
              <% end %>
            </td>
            <td><%= (l notificacao.data) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </fieldset>
</div>